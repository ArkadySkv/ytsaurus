package NYT.NTabletClient.NProto;

import "yt/core/misc/guid.proto";
import "yt/ytlib/hive/transaction_supervisor_service.proto";
import "yt/ytlib/chunk_client/chunk.proto";

////////////////////////////////////////////////////////////////////////////////

message TReqStartTransactionExt
{
    extend NYT.NHive.NProto.TReqStartTransaction
    {
        optional TReqStartTransactionExt start_transaction_ext = 101;
    }

    required int64 start_timestamp = 1;

    // Transaction timeout (in ms).
    optional int32 timeout = 2;

    // NB: Tablet transaction ids are generated by clients.
    optional NYT.NProto.TGuid transaction_id = 3;
}

////////////////////////////////////////////////////////////////////////////////

message TReqWrite
{
    required NYT.NProto.TGuid transaction_id = 1;
    required NYT.NProto.TGuid tablet_id = 2;
    required NYT.NChunkClient.NProto.TChunkMeta chunk_meta = 3;
    // Chunk blocks are passed via attachments.
}

message TRspWrite
{ }

////////////////////////////////////////////////////////////////////////////////

message TReqLookup
{
    required NYT.NProto.TGuid tablet_id = 1;
    required bytes key = 2;
    required int64 timestamp = 3;
    optional bool all_columns = 4 [default = true];
    repeated string columns = 5;
}

message TRspLookup
{
    required NYT.NChunkClient.NProto.TChunkMeta chunk_meta = 1;
    // Chunk blocks are passed via attachments.
}

////////////////////////////////////////////////////////////////////////////////

message TReqDelete
{
    required NYT.NProto.TGuid transaction_id = 1;
    required NYT.NProto.TGuid tablet_id = 2;
    repeated bytes keys = 3;
}

message TRspDelete
{ }

////////////////////////////////////////////////////////////////////////////////

