package NYT.NChunkServer.NProto;

import "yt/ytlib/misc/guid.proto";
import "yt/server/chunk_server/chunk_service.proto";

////////////////////////////////////////////////////////////////////////////////

message TMetaReqRegisterNode
{
    required string address = 1;
    required NYT.NProto.TGuid incarnation_id = 2;
    required TNodeStatistics statistics = 3;
}

message TMetaRspRegisterNode
{
    required int32 node_id = 1;
}

message TMetaReqUnregisterNode
{
    required int32 node_id = 1;
}

// Full heartbeat changes are typcially large and as passed as-is in
// form of RPC requests. Hence we don't have any special
// TMsgFullHeartbeat type here.

message TMetaReqIncrementalHeartbeat
{
    required int32 node_id = 1;
    required TNodeStatistics statistics = 2;
    repeated TChunkAddInfo added_chunks = 3;
    repeated TChunkRemoveInfo removed_chunks = 4;
}

message TMetaReqUpdateJobs
{
    required int32 node_id = 1;
    repeated TJobStartInfo started_jobs = 2;
    repeated TJobStopInfo stopped_jobs = 3;
}

message TMetaReqUpdateChunkReplicationFactor
{
    message TUpdate
    {
        required NYT.NProto.TGuid chunk_id = 1;
        required int32 replication_factor = 2;
    }

    repeated TUpdate updates = 1;
}

////////////////////////////////////////////////////////////////////////////////

