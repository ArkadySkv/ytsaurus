PROGRAM(server)

SRCS(
    main.cpp
)

IF (WIN32)
    SET(CMAKE_EXE_LINKER_FLAGS_DEBUG   "${CMAKE_EXE_LINKER_FLAGS_DEBUG}   /LIBPATH:${SOURCE_ROOT}/lib/Debug   yajl.lib")
    SET(CMAKE_EXE_LINKER_FLAGS_RELEASE "${CMAKE_EXE_LINKER_FLAGS_RELEASE} /LIBPATH:${SOURCE_ROOT}/lib/Release yajl.lib")
ENDIF (WIN32)

IF (UNIX)
  IF (MAKE_ONLY_SHARED_LIB OR BUILD_SHARED_LIBS)
    # Cool cmake! Next line not passed to linker!
    # SET(CMAKE_EXE_LINKER_FLAGS "${CMAKE_EXE_LINKER_FLAGS} -L${SOURCE_ROOT}/lib -lyajl")
    # Next two lines give expected result. Thanks, CMake team, for this!
    #SET(CMAKE_EXE_LINKER_FLAGS_DEBUG "${CMAKE_EXE_LINKER_FLAGS_DEBUG} -L${SOURCE_ROOT}/lib -lyajl")
    #SET(CMAKE_EXE_LINKER_FLAGS_RELEASE "${CMAKE_EXE_LINKER_FLAGS_RELEASE} -L${SOURCE_ROOT}/lib -lyajl")
  ELSE (MAKE_ONLY_SHARED_LIB OR BUILD_SHARED_LIBS)
    SET(CMAKE_CXX_LINK_EXECUTABLE "${CMAKE_CXX_LINK_EXECUTABLE} -L${SOURCE_ROOT}/lib -lyajl_s")
  ENDIF (MAKE_ONLY_SHARED_LIB OR BUILD_SHARED_LIBS)
ENDIF (UNIX)

PEERDIR(
    ADDINCL yt/ytlib
    dict/json
)

DEFAULT(INSTALLDIR ${INSTALL_BIN_DIR})
SET(INSTALLEDNAME ${PROG})

END()
